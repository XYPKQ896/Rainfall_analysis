---
title: "How dates and locations affect the rainfall."
subtitle: "The relationship between dates, locations and rainfall"
author: 
  - Rui Hu
thanks: "Code and data are available at: https://open.toronto.ca/"
date: 09/23/2024
date-format: MM/DD/YYYY
abstract: "Rainfall associates with citizens. The purpose is to analysis the rainfall of Toronto. The data about Rain Gauge Locations and Precipitation from opendatatoronto contains locations and rainfall. It shows that the rainfall associates dates and locations."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
data <- read_csv(here::here("data/analysis_data/analysis_data.csv"))
```


# Introduction

  Rainfall is one of most important natural phenomena of the environment. It associates with all humans’ activity. For individuals, we need to decide whether we should take an umbrella this day. For restaurants, how much food they should prepare every morning. A rainy day can’t attract the same number of customers as a sunny day. For farmers, they need to decide the best time to plant or harvest. City authorities should prepare for the possible heavy rain in the future.

  As a result, this paper purposes to understand the rainfall and contribute to the agriculture, environment protection and city planning. We use data from @opendatatoronto in order to disclose the relationship between precipitation, locations and seasons. 
  
\newpage

The remainder of this paper is structured as follows. 

@sec-data Data

@sec-model Model

@sec-model_set-up Model set-up

@sec-model_justification Model justification

@sec-results Results

@sec-discussion Discussion

@sec-first-point First point

@sec-second-point Second point

@sec-third-point Third point

@sec-weeknesses Weaknesses and next steps

@sec-additional Additional data details

@sec-model-details Model details

\newpage

# Data {#sec-data}

Some of our data is of daily precipitation (@fig-daily), from @opendatatoronto.

```{r}
#| label: fig-daily
#| fig-cap: Daily Precipitation
#| echo: false

daily <- filter(data, data$longitude == -79.4781121, data$latitude == 43.6476803)
ggplot(daily, aes(x = date, y = Total_Rainfall)) +
  geom_line(color = "blue") +
  labs(title = "Daily Precipitation", 
       x = "Date", 
       y = "Rainfall (mm)")
```

In this figure, the location is fixed as (longitude=-79.4781121, latitude=43.6476803). In order to find the rainfall everyday from January to September, daily precipitation shows rainfall in mm.

And also planes (@fig-monthly). Daily precipitation is not able to find a rule for the rainfall. Monthly precipitation gathers elements in daily precipitation.

```{r}
#| label: fig-monthly
#| fig-cap: Monthly Precipitation
#| fig-pos: H
#| echo: false
#| warning: false
#| message: false

monthly <- daily %>% 
  mutate(month = format(date, "%Y-%m")) %>%
  group_by(month) %>%
  summarize(monthly_rainfall = sum(Total_Rainfall))

ggplot(monthly, aes(x = month, y = monthly_rainfall)) +
  geom_bar(stat = "identity", color = "blue") +
  labs(title = "Monthly Precipitation", 
       x = "Month", 
       y = "Rainfall (mm)")


```

Variables in two figures are the following:
  Rainfall: precipitation measured by rain gauge equipment (mm)
  Date: Every day from January to September.
  Month: Every month from January to September.


# Model{#sec-model}

The goal of our modelling strategy is twofold. Firstly, it tells the relationship between precipitation and longitude is positive or negative. Secondly, it tells the relationship between precipitation and latitude is positive or negative.

Here we briefly describe the linear regression model used to investigate the effects of longitude and latitude on precipitation.
Background details and diagnostics are included in [Appendix -@sec-model-details].

## Model set-up{#sec-model_set-up}

Define $y$ as the total rainfall in 2024. Then $x_1$ is the longitude and $x_2$ is the latitude.  

\begin{align} 
y = ax_1 +bx_2 + e
\end{align}

We run the model in R [@citeR].


### Model justification{#sec-model_justification}

We expect a positive relationship between the size of the wings and time spent aloft. In particular...

We can use maths by including latex between dollar signs, for instance $\theta$.


# Results{#sec-results}

```{r}
#| echo: false
#| eval: true
#| label: tbl-modelresults
#| tbl-cap: "Explanatory models of precipitation based on longitude and latitude"
#| warning: false
#| include: false

modeldata <- data %>% group_by(longitude, latitude) %>% summarize(year_rainfall = sum(Total_Rainfall))
lm(year_rainfall ~ longitude + latitude, modeldata)
```

\begin{align} 
y = -389.9x_1 +934.7x_2 -71080.4
\end{align}


# Discussion{#sec-discussion}

## First discussion point {#sec-first-point}

When talk about rainfall, one purpose is that the rain is only formed by (). It means that the precipitation everyday is totally random just as the data which we simulated in figure 1. From our daily life, when today is rain, the precipitation is larger than not rainy day. The data we simulated shows that, the rainy days are random choose. We are not able to find any rules from it. However, in the real data which gets from opendatatoronto (figure2), it is totally wrong. Although it is same that some days rain and some days sunny, July seems to have more days rainy and also the precipitation is higher than other months. In order to find more about it, the bar plot in (figure 3) merge every days in to months. So we can see the total precipitation every month. We can easily find that July is higher than other weeks. 

## Second discussion point{#sec-second-point}

## Third discussion point{#sec-third-point}

## Weaknesses and next steps{#sec-weeknesses}

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional data details{#sec-additional}

# Model details {#sec-model-details}



\newpage


# References


